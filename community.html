<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ç‰‡ç¿¼ã®ç›Ÿç´„é¨å£«å›£ - ä¼šå“¡ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£">
    <title>ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ | ç‰‡ç¿¼ã®ç›Ÿç´„é¨å£«å›£</title>
    <link rel="stylesheet" href="style.css">
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6577274024673800"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://www.google.com/recaptcha/api.js?render=6Lc8JSosAAAAANfpYbwb4-X11lIZnMoEY46kkLh1"></script>
    <style>
        /* ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ãƒšãƒ¼ã‚¸å°‚ç”¨ã‚¹ã‚¿ã‚¤ãƒ« */
        :root {
            --primary-color: #1e40af;
            --primary-dark: #1e3a5f;
            --secondary-color: #059669;
            --text-dark: #1f2937;
            --text-light: #6b7280;
            --bg-light: #f8fafc;
        }

        body {
            font-family: 'Noto Sans JP', sans-serif;
            background: var(--bg-light);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        /* ãƒ­ã‚°ã‚¤ãƒ³ã‚²ãƒ¼ãƒˆ */
        .login-gate {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .login-gate.hidden {
            display: none;
        }

        .login-modal {
            background: white;
            border-radius: 20px;
            padding: 2.5rem;
            max-width: 400px;
            width: 90%;
            text-align: center;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
        }

        .login-modal h2 {
            margin-bottom: 1rem;
            color: var(--primary-dark);
        }

        .login-modal p {
            color: var(--text-light);
            margin-bottom: 1.5rem;
        }

        .login-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            width: 100%;
            padding: 1rem;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            margin-bottom: 0.75rem;
        }

        .login-btn.google {
            background: #4285f4;
            color: white;
        }

        .login-btn.google:hover {
            background: #3367d6;
        }

        .login-btn.demo {
            background: #f3f4f6;
            color: var(--text-dark);
            border: 2px solid #d1d5db;
        }

        .login-btn.demo:hover {
            background: #e5e7eb;
        }

        .back-link {
            margin-top: 1rem;
            display: inline-block;
            color: var(--text-light);
            text-decoration: none;
        }

        /* ãƒ˜ãƒƒãƒ€ãƒ¼ */
        .community-header {
            background: linear-gradient(135deg, #1e3a5f, #2d5a87);
            color: white;
            padding: 1.5rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-inner {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .header-logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            text-decoration: none;
            color: white;
        }

        .header-logo img {
            width: 40px;
            height: 40px;
        }

        .header-logo span {
            font-weight: 700;
            font-size: 1.1rem;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 0.9rem;
        }

        .logout-btn {
            padding: 0.5rem 1rem;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 8px;
            color: white;
            cursor: pointer;
        }

        /* ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ */
        .community-nav {
            background: white;
            border-bottom: 1px solid #e5e7eb;
            padding: 0.5rem 0;
            position: sticky;
            top: 68px;
            z-index: 99;
        }

        .nav-items {
            display: flex;
            gap: 0.5rem;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .nav-item {
            padding: 0.75rem 1.25rem;
            border: none;
            background: transparent;
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--text-light);
            cursor: pointer;
            white-space: nowrap;
            border-radius: 8px;
            transition: all 0.2s;
        }

        .section-block:nth-child(even) {
            background: var(--bg-light);
        }

        /* ===== æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ã‚µã‚¤ãƒ‰ãƒãƒ¼ ===== */
        .experiences-container {
            display: grid;
            grid-template-columns: 260px 1fr;
            gap: 2rem;
            align-items: start;
        }

        .filters-sidebar {
            position: sticky;
            top: 85px;
            /* ãƒ˜ãƒƒãƒ€ãƒ¼è€ƒæ…® */
        }

        .filter-box {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid #e5e7eb;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.03);
        }

        .filter-heading {
            font-size: 1.1rem;
            color: var(--primary-dark);
            margin-bottom: 1.25rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            border-bottom: 2px solid #f3f4f6;
            padding-bottom: 0.75rem;
        }

        .filter-group {
            margin-bottom: 1.5rem;
        }

        .filter-group:last-child {
            margin-bottom: 0;
        }

        .filter-label {
            display: block;
            font-weight: 700;
            font-size: 0.95rem;
            margin-bottom: 0.75rem;
            color: #374151;
            display: flex;
            align-items: center;
            gap: 0.4rem;
        }

        .checkbox-list {
            display: flex;
            flex-direction: column;
            gap: 0.6rem;
            max-height: 400px;
            overflow-y: auto;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 0.6rem;
            font-size: 0.9rem;
            color: var(--text-dark);
            cursor: pointer;
            line-height: 1.4;
            transition: color 0.2s;
        }

        .checkbox-item:hover {
            color: var(--primary-color);
        }

        .checkbox-item input[type="checkbox"] {
            width: 16px;
            height: 16px;
            accent-color: var(--primary-color);
            cursor: pointer;
        }

        @media (max-width: 900px) {
            .experiences-container {
                grid-template-columns: 1fr;
            }

            .filters-sidebar {
                position: static;
                margin-bottom: 2rem;
            }
        }

        .nav-item.active {
            background: var(--primary-color);
            color: white;
        }

        /* ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ */
        .community-main {
            padding: 1.5rem 0 3rem;
        }

        /* ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
        .page-section {
            display: none;
        }

        .page-section.active {
            display: block;
        }

        /* ã‚«ãƒ¼ãƒ‰ */
        .content-card {
            background: white;
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            margin-bottom: 1.5rem;
        }

        /* ãƒ•ã‚©ãƒ¼ãƒ  */
        .form-group {
            margin-bottom: 1.25rem;
        }

        .form-label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-dark);
        }

        .required {
            color: #dc2626;
            font-size: 0.8rem;
        }

        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            padding: 0.875rem;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.2s;
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .form-textarea {
            resize: vertical;
            min-height: 120px;
        }

        /* ãƒ©ã‚¸ã‚ª */
        .radio-group {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .radio-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
            padding: 0.5rem 0.75rem;
            background: #f3f4f6;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .radio-item:hover {
            background: #e5e7eb;
        }

        /* ã‚¿ã‚°ãƒãƒƒãƒ— */
        .tag-category {
            margin-bottom: 0.75rem;
        }

        .tag-category-label {
            display: block;
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--text-light);
            margin-bottom: 0.5rem;
        }

        .tag-chips {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .tag-chip {
            padding: 0.5rem 1rem;
            border: 2px solid #d1d5db;
            border-radius: 20px;
            background: white;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .tag-chip:hover {
            border-color: var(--primary-color);
        }

        .tag-chip.selected {
            background: var(--primary-color);
            border-color: var(--primary-color);
            color: white;
        }

        /* ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰è­¦å‘Š */
        .upload-warning {
            background: #fef2f2;
            border: 1px solid #fca5a5;
            border-radius: 8px;
            padding: 0.75rem;
            margin-bottom: 0.75rem;
            font-size: 0.85rem;
            color: #dc2626;
        }

        /* ãƒœã‚¿ãƒ³ */
        .btn {
            padding: 0.875rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            min-height: 48px;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
        }

        /* æ¤œç´¢ãƒãƒ¼ */
        .search-bar {
            display: flex;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .search-input {
            flex: 1;
            min-width: 200px;
            padding: 0.875rem;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            font-size: 1rem;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        /* éƒ½é“åºœçœŒã‚°ãƒªãƒƒãƒ‰ */
        .prefecture-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 0.75rem;
            margin-bottom: 2rem;
        }

        .prefecture-card {
            padding: 1rem;
            background: white;
            border-radius: 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            border: 2px solid transparent;
        }

        .prefecture-card:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
        }

        .prefecture-card.active {
            border-color: var(--primary-color);
            background: #eff6ff;
        }

        .prefecture-name {
            font-weight: 600;
            color: var(--text-dark);
        }

        .prefecture-count {
            font-size: 0.85rem;
            color: var(--text-light);
            margin-top: 0.25rem;
        }

        /* ä½“é¨“è«‡ãƒªã‚¹ãƒˆ */
        .experience-list {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .experience-item {
            display: flex;
            gap: 0.75rem;
            padding: 1.25rem;
            background: white;
            border-radius: 12px;
            border-left: 4px solid var(--secondary-color);
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
        }

        .experience-item:hover {
            transform: translateX(3px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .experience-icon {
            font-size: 1.5rem;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--bg-light);
            border-radius: 12px;
            flex-shrink: 0;
        }

        .experience-content {
            flex: 1;
            min-width: 0;
        }

        .experience-header {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            align-items: center;
            margin-bottom: 0.25rem;
        }

        .experience-name {
            font-weight: 700;
            color: var(--primary-dark);
        }

        .experience-meta {
            font-size: 0.8rem;
            color: var(--text-light);
        }

        .experience-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-dark);
        }

        .experience-summary {
            font-size: 0.9rem;
            color: var(--text-light);
            display: -webkit-box;
            -webkit-line-clamp: 2;
            line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .experience-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.25rem;
            margin-top: 0.75rem;
        }

        .tag-mini {
            padding: 0.2rem 0.6rem;
            background: #e0e7ff;
            border-radius: 10px;
            font-size: 0.75rem;
            color: #4338ca;
        }

        .experience-footer {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin-top: 0.75rem;
            font-size: 0.85rem;
            color: var(--text-light);
            align-items: center;
        }

        .action-btn {
            background: transparent;
            border: 1px solid #d1d5db;
            border-radius: 20px;
            padding: 0.25rem 0.75rem;
            cursor: pointer;
            font-size: 0.85rem;
            color: var(--text-light);
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .action-btn:hover {
            background: #f3f4f6;
            color: var(--primary-color);
            border-color: var(--primary-color);
        }

        /* ãŠã™ã™ã‚ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
        .recommend-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1rem;
        }

        .recommend-card {
            background: white;
            border-radius: 12px;
            padding: 1.25rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
        }

        .recommend-card h4 {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.75rem;
            color: var(--primary-dark);
        }

        .recommend-list {
            list-style: none;
            padding: 0;
        }

        .recommend-list li {
            padding: 0.5rem 0;
            border-bottom: 1px solid #f3f4f6;
        }

        .recommend-list li:last-child {
            border-bottom: none;
        }

        .recommend-list a {
            color: var(--text-dark);
            text-decoration: none;
        }

        .recommend-list a:hover {
            color: var(--primary-color);
        }

        /* ãŠã™ã™ã‚ã‚«ãƒ¼ãƒ‰æ–°ã‚¹ã‚¿ã‚¤ãƒ« */
        .recommend-category {
            margin-bottom: 2rem;
        }

        .recommend-cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 1rem;
        }

        .recommend-item-card {
            background: white;
            border-radius: 12px;
            padding: 1rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
            transition: all 0.2s;
            border: 1px solid #e5e7eb;
        }

        .recommend-item-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
            border-color: var(--primary-color);
        }

        .recommend-item-title {
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 0.25rem;
            font-size: 0.95rem;
        }

        .recommend-item-author {
            color: var(--text-light);
            font-size: 0.85rem;
            margin-bottom: 0.5rem;
        }

        .recommend-item-desc {
            color: var(--text-light);
            font-size: 0.85rem;
            line-height: 1.4;
            margin-bottom: 0.5rem;
        }

        .recommend-item-link {
            display: inline-block;
            color: var(--primary-color);
            font-size: 0.85rem;
            text-decoration: none;
            margin-top: 0.5rem;
        }

        .recommend-item-link:hover {
            text-decoration: underline;
        }

        /* ãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œ */
        @media (max-width: 768px) {
            .header-logo span {
                display: none;
            }

            .prefecture-grid {
                grid-template-columns: repeat(3, 1fr);
            }

            /* ã‚¹ãƒãƒ›ç‰ˆãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã‚’2åˆ—ã‚°ãƒªãƒƒãƒ‰ã« */
            .nav-items {
                display: grid;
                grid-template-columns: repeat(2, 1fr);
                gap: 0.5rem;
                width: 100%;
            }

            .nav-item {
                padding: 0.6rem 0.5rem;
                font-size: 0.75rem;
                text-align: center;
                justify-content: center;
            }

            /* ã‚¹ãƒãƒ›ç‰ˆ: æ”¯æ´ãƒãƒŠãƒ¼ã‚’1åˆ—ã« */
            .support-banner-grid {
                grid-template-columns: 1fr !important;
            }
        }

        /* ===== æ´»å‹•æ”¯æ´ã‚»ã‚¯ã‚·ãƒ§ãƒ³ ===== */
        .support-banner-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1.5rem;
            margin-bottom: 1rem;
        }

        .support-banner-card {
            position: relative;
            border-radius: 16px;
            overflow: hidden;
            cursor: pointer;
            text-decoration: none;
            display: block;
            /* é‡‘è‰²ãƒœãƒ¼ãƒ€ãƒ¼ */
            border: 3px solid #d4af37;
            box-shadow: 0 8px 25px rgba(212, 175, 55, 0.3);
            transition: all 0.3s ease;
        }

        .support-banner-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 15px 40px rgba(212, 175, 55, 0.5);
            border-color: #ffd700;
        }

        .support-banner-img {
            width: 100%;
            height: 180px;
            background-size: cover;
            background-position: center;
            display: flex;
            align-items: flex-end;
            justify-content: center;
        }

        .support-banner-overlay {
            width: 100%;
            padding: 1.5rem 1rem;
            background: linear-gradient(transparent, rgba(0, 0, 0, 0.8));
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
        }

        .support-banner-icon {
            font-size: 2.5rem;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
        }

        .support-banner-title {
            color: white;
            font-size: 1.1rem;
            font-weight: 700;
            text-shadow: 1px 1px 4px rgba(0, 0, 0, 0.5);
            text-align: center;
        }

        /* ===== æ”¯æ´ãƒ¢ãƒ¼ãƒ€ãƒ« ===== */
        .support-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .support-modal-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
        }

        .support-modal-content {
            position: relative;
            background: white;
            border-radius: 20px;
            padding: 2rem;
            max-width: 450px;
            width: 90%;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
            border: 3px solid #d4af37;
        }

        .support-modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            width: 36px;
            height: 36px;
            border: none;
            background: #f3f4f6;
            border-radius: 50%;
            font-size: 1.5rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .support-modal-close:hover {
            background: #e5e7eb;
            transform: scale(1.1);
        }

        .support-modal-buttons {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .support-modal-buttons.donate-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }

        .support-modal-btn {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1.25rem;
            border-radius: 12px;
            text-decoration: none;
            color: white;
            font-weight: 600;
            transition: all 0.2s;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .support-modal-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        .support-modal-btn.donate-btn {
            flex-direction: column;
            text-align: center;
            gap: 0.5rem;
            padding: 1.5rem 1rem;
        }

        .support-modal-btn-icon {
            font-size: 2rem;
        }

        .support-modal-btn-text {
            font-size: 0.95rem;
            line-height: 1.4;
        }

        .support-modal-btn-text small {
            opacity: 0.8;
            font-size: 0.8rem;
        }

        /* é…ä¿¡æŠ•ã’éŠ­ç”»åƒã‚«ãƒ¼ãƒ‰ */
        .donate-card {
            display: block;
            border-radius: 12px;
            overflow: hidden;
            border: 2px solid #d4af37;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
            transition: all 0.3s ease;
        }

        .donate-card:hover {
            transform: translateY(-5px) scale(1.03);
            box-shadow: 0 8px 25px rgba(212, 175, 55, 0.4);
            border-color: #ffd700;
        }

        .donate-card img {
            width: 100%;
            height: auto;
            display: block;
        }
    </style>
</head>

<body>
    <!-- ãƒ­ã‚°ã‚¤ãƒ³ã‚²ãƒ¼ãƒˆ -->
    <div class="login-gate" id="loginGate">
        <div class="login-modal">
            <h2>ğŸ” ä¼šå“¡ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£</h2>
            <p>ä½“é¨“è«‡ã®æŠ•ç¨¿ãƒ»é–²è¦§ã«ã¯ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ã§ã™</p>

            <!-- ãƒ–ãƒ©ã‚¦ã‚¶äº’æ›æ€§è­¦å‘Š -->
            <div id="browserWarning"
                style="display: none; background: #fef3c7; border: 2px solid #f59e0b; border-radius: 12px; padding: 1rem; margin-bottom: 1rem; text-align: left;">
                <p
                    style="color: #92400e; font-weight: 700; margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">
                    âš ï¸ ãƒ–ãƒ©ã‚¦ã‚¶ã®äº’æ›æ€§ã«é–¢ã™ã‚‹è­¦å‘Š
                </p>
                <p style="color: #78350f; font-size: 0.9rem; margin-bottom: 0.75rem;">
                    ãŠä½¿ã„ã®ãƒ–ãƒ©ã‚¦ã‚¶ï¼ˆ<span id="detectedBrowser"></span>ï¼‰ã§ã¯ã€Googleèªè¨¼ãŒæ­£ã—ãå‹•ä½œã—ãªã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚
                </p>
                <p style="color: #78350f; font-size: 0.85rem; margin-bottom: 0.75rem;">
                    Googleèªè¨¼ã‚’ã”åˆ©ç”¨ã®å ´åˆã¯ã€<strong>Chrome</strong>ã¾ãŸã¯<strong>Safari</strong>ã§é–‹ã„ã¦ãã ã•ã„ã€‚
                </p>
                <button onclick="copyUrlToClipboard()"
                    style="width: 100%; padding: 0.75rem; background: #f59e0b; color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; font-size: 0.9rem;">
                    ğŸ“‹ URLã‚’ã‚³ãƒ”ãƒ¼ã—ã¦å¤–éƒ¨ãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ã
                </button>
            </div>

            <!-- ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒ­ã‚°ã‚¤ãƒ³ -->
            <div style="margin-bottom: 1rem;">
                <input type="email" id="loginEmail" class="form-input" placeholder="ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›"
                    style="margin-bottom: 0.5rem; padding: 0.875rem; border: 2px solid #e5e7eb; border-radius: 8px; width: 100%; box-sizing: border-box;">
                <button class="login-btn" id="btnLoginEmail"
                    style="background: linear-gradient(135deg, #1e40af, #3b82f6); color: white;">
                    ğŸ“§ ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã§ãƒ­ã‚°ã‚¤ãƒ³
                </button>
            </div>

            <p style="color: #9ca3af; font-size: 0.85rem; margin: 0.5rem 0;">ã¾ãŸã¯</p>

            <button class="login-btn google" id="btnLoginGoogle">
                <svg width="20" height="20" viewBox="0 0 24 24">
                    <path fill="currentColor"
                        d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" />
                    <path fill="currentColor"
                        d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" />
                    <path fill="currentColor"
                        d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" />
                    <path fill="currentColor"
                        d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" />
                </svg>
                Googleã§ãƒ­ã‚°ã‚¤ãƒ³
            </button>

            <a href="index.html" class="back-link">â† ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹</a>
        </div>
    </div>

    <script>
        // ãƒ–ãƒ©ã‚¦ã‚¶äº’æ›æ€§ãƒã‚§ãƒƒã‚¯
        (function () {
            const ua = navigator.userAgent;
            let problematicBrowser = null;

            // å•é¡Œã®ã‚ã‚‹ãƒ–ãƒ©ã‚¦ã‚¶ã‚’æ¤œå‡º
            if (/Brave/i.test(ua) || (navigator.brave && navigator.brave.isBrave)) {
                problematicBrowser = 'Brave';
            } else if (/Line\//i.test(ua) || /LIFF/i.test(ua)) {
                problematicBrowser = 'LINE';
            } else if (/Instagram/i.test(ua)) {
                problematicBrowser = 'Instagram';
            } else if (/FBAN|FBAV/i.test(ua)) {
                problematicBrowser = 'Facebook';
            } else if (/Twitter/i.test(ua) || /X-Client/i.test(ua)) {
                problematicBrowser = 'X (Twitter)';
            } else if (/wv\)/i.test(ua) && !/Chrome/i.test(ua)) {
                problematicBrowser = 'ã‚¢ãƒ—ãƒªå†…ãƒ–ãƒ©ã‚¦ã‚¶';
            }

            if (problematicBrowser) {
                const warningEl = document.getElementById('browserWarning');
                const browserNameEl = document.getElementById('detectedBrowser');
                if (warningEl && browserNameEl) {
                    browserNameEl.textContent = problematicBrowser;
                    warningEl.style.display = 'block';
                }
            }
        })();

        function copyUrlToClipboard() {
            navigator.clipboard.writeText(window.location.href).then(function () {
                alert('URLã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼\\nChrome ã¾ãŸã¯ Safari ã«è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ã€‚');
            }).catch(function () {
                // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
                const textArea = document.createElement('textarea');
                textArea.value = window.location.href;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('URLã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼\\nChrome ã¾ãŸã¯ Safari ã«è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ã€‚');
            });
        }
    </script>


    <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <header class="community-header">
        <div class="container">
            <div class="header-inner">
                <a href="index.html" class="header-logo">
                    <img src="images/shield-emblem.png" alt="ãƒ­ã‚´">
                    <span>ç‰‡ç¿¼ã®ç›Ÿç´„é¨å£«å›£</span>
                </a>
                <div class="user-info" id="userInfo" style="display: none;">
                    <span id="userName">ã‚²ã‚¹ãƒˆ</span>
                    <button class="logout-btn" onclick="logout()">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</button>
                </div>
            </div>
        </div>
    </header>

    <!-- ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
    <nav class="community-nav">
        <div class="container">
            <div class="nav-items">
                <button class="nav-item active" data-section="experiences">ğŸ“‹ ã¿ã‚“ãªã®ä½“é¨“è«‡</button>
                <button class="nav-item" data-section="post">ğŸ“ ä½“é¨“è«‡ã‚’æŠ•ç¨¿</button>
                <button class="nav-item" data-section="recommend">ğŸ’¡ ãŠã™ã™ã‚</button>
                <button class="nav-item" data-section="support">ğŸ’ ãƒ’ãƒ­ã®æ´»å‹•æ”¯æ´</button>
            </div>
        </div>
    </nav>

    <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
    <main class="community-main">
        <div class="container">
            <!-- ã¿ã‚“ãªã®ä½“é¨“è«‡ -->
            <section id="section-experiences" class="page-section active">
                <div class="experiences-container">
                    <!-- ã‚µã‚¤ãƒ‰ãƒãƒ¼ï¼ˆãƒ•ã‚£ãƒ«ã‚¿ï¼‰ -->
                    <aside class="filters-sidebar">
                        <div class="filter-box">
                            <h3 class="filter-heading">
                                <span style="font-size: 1.4rem;">ğŸ”</span> æ¡ä»¶ã§çµã‚Šè¾¼ã‚€
                            </h3>

                            <!-- ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ -->
                            <div class="filter-group">
                                <label class="filter-label">ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰</label>
                                <input type="text" class="form-input" id="sidebarSearch" placeholder="ä¾‹ï¼šèª¿åœã€é¢ä¼šäº¤æµ">
                            </div>

                            <!-- ã‚¿ã‚°ãƒ•ã‚£ãƒ«ã‚¿ -->
                            <div class="filter-group">
                                <label class="filter-label">ğŸ·ï¸ ã‚¿ã‚°</label>
                                <div id="tagCheckboxes" class="checkbox-list">
                                    <!-- JSã§ç”Ÿæˆ -->
                                    <div style="color: var(--text-light); font-size: 0.9rem;">ã‚¿ã‚°ã‚’èª­ã¿è¾¼ã¿ä¸­...</div>
                                </div>
                            </div>

                            <!-- æœŸé–“ï¼ˆãƒ€ãƒŸãƒ¼ï¼‰ -->
                            <div class="filter-group">
                                <label class="filter-label">ğŸ“… åˆ¤æ±ºãƒ»äº‹ä»¶ã®æœŸé–“</label>
                                <div class="checkbox-list">
                                    <label class="checkbox-item"><input type="checkbox" name="date-filter">
                                        ç›´è¿‘6ãƒ¶æœˆ</label>
                                    <label class="checkbox-item"><input type="checkbox" name="date-filter"> ç›´è¿‘1å¹´</label>
                                    <label class="checkbox-item"><input type="checkbox" name="date-filter">
                                        2024å¹´</label>
                                    <label class="checkbox-item"><input type="checkbox" name="date-filter">
                                        2023å¹´</label>
                                </div>
                            </div>

                            <!-- çµæœï¼ˆãƒ€ãƒŸãƒ¼ï¼‰ -->
                            <div class="filter-group">
                                <label class="filter-label">ğŸ† çµæœ</label>
                                <div class="checkbox-list">
                                    <label class="checkbox-item"><input type="checkbox" name="result-filter">
                                        å‹è¨´ãƒ»èªå®¹</label>
                                    <label class="checkbox-item"><input type="checkbox" name="result-filter"> å’Œè§£</label>
                                    <label class="checkbox-item"><input type="checkbox" name="result-filter">
                                        æ•—è¨´ãƒ»æ£„å´</label>
                                </div>
                            </div>
                        </div>
                    </aside>

                    <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
                    <div class="experiences-main">
                        <h2 style="margin-bottom: 1rem;">ğŸ“‹ ã¿ã‚“ãªã®ä½“é¨“è«‡ <span id="experienceCount"
                                style="font-weight: normal;"></span></h2>

                        <!-- éƒ½é“åºœçœŒã‚°ãƒªãƒƒãƒ‰ -->
                        <h3 style="margin-bottom: 0.75rem; font-size: 1rem; color: var(--text-light);">ğŸ“ éƒ½é“åºœçœŒã‹ã‚‰æ¢ã™</h3>
                        <div class="prefecture-grid" id="prefectureGrid">
                            <div class="prefecture-card" data-pref="å…¨å›½">
                                <div class="prefecture-name">å…¨å›½</div>
                                <div class="prefecture-count">--ä»¶</div>
                            </div>
                            <div class="prefecture-card" data-pref="æ±äº¬éƒ½">
                                <div class="prefecture-name">æ±äº¬éƒ½</div>
                                <div class="prefecture-count">--ä»¶</div>
                            </div>
                            <div class="prefecture-card" data-pref="å¤§é˜ªåºœ">
                                <div class="prefecture-name">å¤§é˜ªåºœ</div>
                                <div class="prefecture-count">--ä»¶</div>
                            </div>
                            <div class="prefecture-card" data-pref="ç¥å¥ˆå·çœŒ">
                                <div class="prefecture-name">ç¥å¥ˆå·çœŒ</div>
                                <div class="prefecture-count">--ä»¶</div>
                            </div>
                            <div class="prefecture-card" data-pref="æ„›çŸ¥çœŒ">
                                <div class="prefecture-name">æ„›çŸ¥çœŒ</div>
                                <div class="prefecture-count">--ä»¶</div>
                            </div>
                            <div class="prefecture-card" data-pref="åŒ—æµ·é“">
                                <div class="prefecture-name">åŒ—æµ·é“</div>
                                <div class="prefecture-count">--ä»¶</div>
                            </div>
                            <div class="prefecture-card" data-pref="ç¦å²¡çœŒ">
                                <div class="prefecture-name">ç¦å²¡çœŒ</div>
                                <div class="prefecture-count">--ä»¶</div>
                            </div>
                            <div class="prefecture-card" data-pref="åŸ¼ç‰çœŒ">
                                <div class="prefecture-name">åŸ¼ç‰çœŒ</div>
                                <div class="prefecture-count">--ä»¶</div>
                            </div>
                        </div>

                        <!-- ä½“é¨“è«‡ãƒªã‚¹ãƒˆ -->
                        <div
                            style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.75rem;">
                            <h3 style="font-size: 1rem; color: var(--text-light); margin: 0;">ğŸ“„ æœ€æ–°ã®ä½“é¨“è«‡</h3>
                            <!-- ä¸¦ã³æ›¿ãˆãŒå¿…è¦ãªã‚‰ã“ã“ã«è¿½åŠ  -->
                        </div>
                        <div class="experience-list" id="experienceList">
                            <div style="text-align: center; padding: 2rem; color: var(--text-light);">
                                èª­ã¿è¾¼ã¿ä¸­...
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ä½“é¨“è«‡ã‚’æŠ•ç¨¿ -->
            <section id="section-post" class="page-section">
                <h2 style="margin-bottom: 1rem;">ğŸ“ ä½“é¨“è«‡ã‚’æŠ•ç¨¿</h2>

                <div class="content-card">
                    <form id="experience-form" onsubmit="return handleFormSubmit(event)">
                        <!-- ãƒãƒ³ãƒ‰ãƒ«ãƒãƒ¼ãƒ  -->
                        <div class="form-group">
                            <label class="form-label">ãƒãƒ³ãƒ‰ãƒ«ãƒãƒ¼ãƒ  <span class="required">*å¿…é ˆ</span></label>
                            <input type="text" class="form-input" id="handle-name" placeholder="ä¾‹ï¼šæ±äº¬ãƒ‘ãƒ‘" required>
                        </div>

                        <!-- éƒ½é“åºœçœŒ -->
                        <div class="form-group">
                            <label class="form-label">éƒ½é“åºœçœŒ <span class="required">*å¿…é ˆ</span></label>
                            <select class="form-select" id="prefecture" required>
                                <option value="">é¸æŠã—ã¦ãã ã•ã„</option>
                                <option value="åŒ—æµ·é“">åŒ—æµ·é“</option>
                                <option value="é’æ£®çœŒ">é’æ£®çœŒ</option>
                                <option value="å²©æ‰‹çœŒ">å²©æ‰‹çœŒ</option>
                                <option value="å®®åŸçœŒ">å®®åŸçœŒ</option>
                                <option value="ç§‹ç”°çœŒ">ç§‹ç”°çœŒ</option>
                                <option value="å±±å½¢çœŒ">å±±å½¢çœŒ</option>
                                <option value="ç¦å³¶çœŒ">ç¦å³¶çœŒ</option>
                                <option value="èŒ¨åŸçœŒ">èŒ¨åŸçœŒ</option>
                                <option value="æ ƒæœ¨çœŒ">æ ƒæœ¨çœŒ</option>
                                <option value="ç¾¤é¦¬çœŒ">ç¾¤é¦¬çœŒ</option>
                                <option value="åŸ¼ç‰çœŒ">åŸ¼ç‰çœŒ</option>
                                <option value="åƒè‘‰çœŒ">åƒè‘‰çœŒ</option>
                                <option value="æ±äº¬éƒ½">æ±äº¬éƒ½</option>
                                <option value="ç¥å¥ˆå·çœŒ">ç¥å¥ˆå·çœŒ</option>
                                <option value="æ–°æ½ŸçœŒ">æ–°æ½ŸçœŒ</option>
                                <option value="å¯Œå±±çœŒ">å¯Œå±±çœŒ</option>
                                <option value="çŸ³å·çœŒ">çŸ³å·çœŒ</option>
                                <option value="ç¦äº•çœŒ">ç¦äº•çœŒ</option>
                                <option value="å±±æ¢¨çœŒ">å±±æ¢¨çœŒ</option>
                                <option value="é•·é‡çœŒ">é•·é‡çœŒ</option>
                                <option value="å²é˜œçœŒ">å²é˜œçœŒ</option>
                                <option value="é™å²¡çœŒ">é™å²¡çœŒ</option>
                                <option value="æ„›çŸ¥çœŒ">æ„›çŸ¥çœŒ</option>
                                <option value="ä¸‰é‡çœŒ">ä¸‰é‡çœŒ</option>
                                <option value="æ»‹è³€çœŒ">æ»‹è³€çœŒ</option>
                                <option value="äº¬éƒ½åºœ">äº¬éƒ½åºœ</option>
                                <option value="å¤§é˜ªåºœ">å¤§é˜ªåºœ</option>
                                <option value="å…µåº«çœŒ">å…µåº«çœŒ</option>
                                <option value="å¥ˆè‰¯çœŒ">å¥ˆè‰¯çœŒ</option>
                                <option value="å’Œæ­Œå±±çœŒ">å’Œæ­Œå±±çœŒ</option>
                                <option value="é³¥å–çœŒ">é³¥å–çœŒ</option>
                                <option value="å³¶æ ¹çœŒ">å³¶æ ¹çœŒ</option>
                                <option value="å²¡å±±çœŒ">å²¡å±±çœŒ</option>
                                <option value="åºƒå³¶çœŒ">åºƒå³¶çœŒ</option>
                                <option value="å±±å£çœŒ">å±±å£çœŒ</option>
                                <option value="å¾³å³¶çœŒ">å¾³å³¶çœŒ</option>
                                <option value="é¦™å·çœŒ">é¦™å·çœŒ</option>
                                <option value="æ„›åª›çœŒ">æ„›åª›çœŒ</option>
                                <option value="é«˜çŸ¥çœŒ">é«˜çŸ¥çœŒ</option>
                                <option value="ç¦å²¡çœŒ">ç¦å²¡çœŒ</option>
                                <option value="ä½è³€çœŒ">ä½è³€çœŒ</option>
                                <option value="é•·å´çœŒ">é•·å´çœŒ</option>
                                <option value="ç†Šæœ¬çœŒ">ç†Šæœ¬çœŒ</option>
                                <option value="å¤§åˆ†çœŒ">å¤§åˆ†çœŒ</option>
                                <option value="å®®å´çœŒ">å®®å´çœŒ</option>
                                <option value="é¹¿å…å³¶çœŒ">é¹¿å…å³¶çœŒ</option>
                                <option value="æ²–ç¸„çœŒ">æ²–ç¸„çœŒ</option>
                            </select>
                        </div>

                        <!-- æ‹…å½“è£åˆ¤æ‰€ -->
                        <div class="form-group">
                            <label class="form-label">æ‹…å½“è£åˆ¤æ‰€ï¼ˆä»»æ„ï¼‰</label>
                            <input type="text" class="form-input" id="court" placeholder="ä¾‹ï¼šæ±äº¬å®¶åº­è£åˆ¤æ‰€">
                        </div>

                        <!-- ç¾åœ¨ã®ãƒ•ã‚§ãƒ¼ã‚º -->
                        <div class="form-group">
                            <label class="form-label">ç¾åœ¨ã®ãƒ•ã‚§ãƒ¼ã‚º</label>
                            <div class="radio-group">
                                <label class="radio-item"><input type="radio" name="phase" value="åˆ¥å±…ç›´å¾Œ"> åˆ¥å±…ç›´å¾Œ</label>
                                <label class="radio-item"><input type="radio" name="phase" value="èª¿åœä¸­"> èª¿åœä¸­</label>
                                <label class="radio-item"><input type="radio" name="phase" value="å¯©åˆ¤ä¸­"> å¯©åˆ¤ä¸­</label>
                                <label class="radio-item"><input type="radio" name="phase" value="é«˜è£"> é«˜è£</label>
                                <label class="radio-item"><input type="radio" name="phase" value="çµå¯©å¾Œ"> çµå¯©å¾Œ</label>
                                <label class="radio-item"><input type="radio" name="phase" value="ãã®ä»–"> ãã®ä»–</label>
                            </div>
                        </div>

                        <!-- ã‚¿ã‚°é¸æŠ -->
                        <div class="form-group">
                            <label class="form-label">ã‚¿ã‚°ã‚’é¸æŠï¼ˆè¤‡æ•°å¯ï¼‰</label>

                            <div class="tag-category">
                                <span class="tag-category-label">ğŸ‘¶ å­ä¾›å±æ€§</span>
                                <div class="tag-chips">
                                    <button type="button" class="tag-chip" data-tag="å¨˜">å¨˜</button>
                                    <button type="button" class="tag-chip" data-tag="æ¯å­">æ¯å­</button>
                                    <button type="button" class="tag-chip" data-tag="ä¹³å…">ä¹³å…</button>
                                    <button type="button" class="tag-chip" data-tag="å¹¼å…">å¹¼å…</button>
                                    <button type="button" class="tag-chip" data-tag="å°å­¦ç”Ÿä»¥ä¸Š">å°å­¦ç”Ÿä»¥ä¸Š</button>
                                    <button type="button" class="tag-chip" data-tag="å­ä¾›è¤‡æ•°">å­ä¾›è¤‡æ•°</button>
                                </div>
                            </div>

                            <div class="tag-category">
                                <span class="tag-category-label">ğŸ‘¤ å½“äº‹è€…</span>
                                <div class="tag-chips">
                                    <button type="button" class="tag-chip" data-tag="å¦»å´">å¦»å´</button>
                                    <button type="button" class="tag-chip" data-tag="å¤«å´">å¤«å´</button>
                                    <button type="button" class="tag-chip" data-tag="å®Ÿå®¶é€£ã‚Œå»ã‚Š">å®Ÿå®¶é€£ã‚Œå»ã‚Š</button>
                                </div>
                            </div>

                            <div class="tag-category">
                                <span class="tag-category-label">âš–ï¸ å¼è­·å£«ä»‹å…¥</span>
                                <div class="tag-chips">
                                    <button type="button" class="tag-chip" data-tag="è‡ªå¼ã‚ã‚Š">è‡ªå¼ã‚ã‚Š</button>
                                    <button type="button" class="tag-chip" data-tag="ç›¸æ‰‹å¼ã‚ã‚Š">ç›¸æ‰‹å¼ã‚ã‚Š</button>
                                </div>
                            </div>

                            <div class="tag-category">
                                <span class="tag-category-label">ğŸ“‹ èƒŒæ™¯ãƒ»çŠ¶æ³</span>
                                <div class="tag-chips">
                                    <button type="button" class="tag-chip" data-tag="ä¸å€«">ä¸å€«</button>
                                    <button type="button" class="tag-chip" data-tag="DVå†¤ç½ª">DVå†¤ç½ª</button>
                                    <button type="button" class="tag-chip" data-tag="é¢ä¼šäº¤æµ">é¢ä¼šäº¤æµ</button>
                                    <button type="button" class="tag-chip" data-tag="è¦ªæ¨©äº‰ã„">è¦ªæ¨©äº‰ã„</button>
                                    <button type="button" class="tag-chip" data-tag="é¤Šè‚²è²»">é¤Šè‚²è²»</button>
                                    <button type="button" class="tag-chip" data-tag="å®Ÿå®¶ä»‹å…¥">å®Ÿå®¶ä»‹å…¥</button>
                                    <button type="button" class="tag-chip" data-tag="ç²¾ç¥ç–¾æ‚£">ç²¾ç¥ç–¾æ‚£</button>
                                </div>
                            </div>

                            <div style="margin-top: 0.75rem;">
                                <input type="text" class="form-input" id="custom-tags" placeholder="ãã®ä»–ã‚¿ã‚°ï¼ˆã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šï¼‰">
                            </div>
                        </div>

                        <!-- ã‚¿ã‚¤ãƒˆãƒ« -->
                        <div class="form-group">
                            <label class="form-label">ã‚¿ã‚¤ãƒˆãƒ« <span class="required">*å¿…é ˆ</span></label>
                            <input type="text" class="form-input" id="experience-title" placeholder="ä¾‹ï¼šèª¿åœã§é¢ä¼šäº¤æµãŒèªã‚ã‚‰ã‚ŒãŸçµŒé¨“"
                                required>
                        </div>

                        <!-- ä½“é¨“è«‡æœ¬æ–‡ -->
                        <div class="form-group">
                            <label class="form-label">ä½“é¨“è«‡ <span class="required">*å¿…é ˆ</span></label>
                            <textarea class="form-textarea" id="experience-text" rows="8"
                                placeholder="ã‚ãªãŸã®çµŒé¨“ã‚’å…±æœ‰ã—ã¦ãã ã•ã„ã€‚åŒã˜å¢ƒé‡ã®æ–¹ã®å‚è€ƒã«ãªã‚Šã¾ã™ã€‚" required></textarea>
                        </div>

                        <!-- ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ -->
                        <div class="form-group">
                            <label class="form-label">ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ï¼ˆä»»æ„ï¼‰</label>
                            <div class="upload-warning">
                                âš ï¸ <strong>å€‹äººåãƒ»ä½æ‰€ã¯å¿…ãšé»’å¡—ã‚Šã—ã¦ãã ã•ã„</strong><br>
                                åˆ¤æ±ºæ–‡ç­‰ã‚’æ²è¼‰ã™ã‚‹å ´åˆã€å€‹äººãŒç‰¹å®šã§ãã‚‹æƒ…å ±ã¯å¿…ãšéš ã—ã¦ãã ã•ã„ã€‚
                            </div>
                            <input type="file" id="image-upload" accept="image/*"
                                style="width: 100%; padding: 0.75rem; border: 2px dashed #d1d5db; border-radius: 8px;">
                        </div>

                        <button type="submit" class="btn btn-primary" style="width: 100%;">
                            æŠ•ç¨¿ã™ã‚‹
                        </button>
                        <p
                            style="text-align: center; margin-top: 0.75rem; font-size: 0.85rem; color: var(--text-light);">
                            â€»æŠ•ç¨¿ã¯ç®¡ç†è€…ã®æ‰¿èªå¾Œã«å…¬é–‹ã•ã‚Œã¾ã™
                        </p>
                    </form>
                </div>
            </section>

            <!-- ãŠã™ã™ã‚ -->
            <section id="section-recommend" class="page-section">
                <h2 style="margin-bottom: 1rem;">ğŸ’¡ ãŠã™ã™ã‚ã‚³ãƒ³ãƒ†ãƒ³ãƒ„</h2>
                <p style="margin-bottom: 1rem; font-size: 0.9rem; color: var(--text-light);">
                    â€»ç®¡ç†äººãŒ <code>data/recommendations.json</code> ã‚’ç·¨é›†ã—ã¦æ›´æ–°ã§ãã¾ã™
                </p>

                <div class="recommend-grid" id="recommendGrid">
                    <!-- JSONã‹ã‚‰å‹•çš„ã«èª­ã¿è¾¼ã¿ -->
                    <div style="text-align: center; padding: 2rem; color: var(--text-light);">
                        èª­ã¿è¾¼ã¿ä¸­...
                    </div>
                </div>
            </section>

            <!-- ãƒ’ãƒ­ã®æ´»å‹•æ”¯æ´ -->
            <section id="section-support" class="page-section">
                <h2 style="margin-bottom: 1rem; text-align: center;">ğŸ’ ãƒ’ãƒ­ã®æ´»å‹•æ”¯æ´</h2>
                <p style="text-align: center; margin-bottom: 1.5rem; color: var(--text-light);">
                    æ¥½ã—ã¿ãªãŒã‚‰ãƒ’ãƒ­ã®æ´»å‹•ã‚’å¿œæ´ã—ã¦ãã ã•ã„ï¼
                </p>

                <!-- 4ã¤ã®æ”¯æ´ãƒãƒŠãƒ¼ã‚°ãƒªãƒƒãƒ‰ -->
                <div class="support-banner-grid">
                    <!-- (A) Twitchã‚µãƒ–ã‚¹ã‚¯ -->
                    <a href="https://www.twitch.tv/meiyakuknights" target="_blank" class="support-banner-card"
                        id="banner-twitch">
                        <div class="support-banner-img" style="background-image: url('images/support-twitch.png');">
                            <div class="support-banner-overlay">
                                <span class="support-banner-icon">ğŸŸ£</span>
                                <span class="support-banner-title">Twitchã‚µãƒ–ã‚¹ã‚¯æ”¯æ´</span>
                            </div>
                        </div>
                    </a>

                    <!-- (B) OFUSE -->
                    <a href="https://ofuse.me/7f899809" target="_blank" class="support-banner-card" id="banner-ofuse">
                        <div class="support-banner-img" style="background-image: url('images/support-ofuse.png');">
                            <div class="support-banner-overlay">
                                <span class="support-banner-icon">ğŸ’Œ</span>
                                <span class="support-banner-title">OFUSEãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ”¯æ´</span>
                            </div>
                        </div>
                    </a>

                    <!-- (C) Amazonï¼ˆãƒ¢ãƒ¼ãƒ€ãƒ«ï¼‰ -->
                    <div class="support-banner-card" onclick="openAmazonModal()">
                        <div class="support-banner-img" style="background-image: url('images/support-amazon.jpg');">
                            <div class="support-banner-overlay">
                                <span class="support-banner-icon">ğŸ›’</span>
                                <span class="support-banner-title">Amazonã§æ”¯æ´ã™ã‚‹</span>
                            </div>
                        </div>
                    </div>

                    <!-- (D) é…ä¿¡æŠ•ã’éŠ­ï¼ˆãƒ¢ãƒ¼ãƒ€ãƒ«ï¼‰ -->
                    <div class="support-banner-card" onclick="openDonateModal()">
                        <div class="support-banner-img" style="background-image: url('images/support-donate.jpg');">
                            <div class="support-banner-overlay">
                                <span class="support-banner-icon">ğŸ</span>
                                <span class="support-banner-title">é…ä¿¡ä¸­æŠ•ã’éŠ­</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ã‚µãƒ–ã‚¹ã‚¯æ”¯æ´ã£ã¦ä½•ï¼Ÿ èª¬æ˜ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
                <div
                    style="margin-top: 2rem; background: white; border-radius: 16px; padding: 1.5rem; box-shadow: 0 4px 15px rgba(0,0,0,0.08);">
                    <h3 style="text-align: center; margin-bottom: 1rem; color: var(--primary-dark); font-size: 1.2rem;">
                        ğŸ¤” ã‚µãƒ–ã‚¹ã‚¯æ”¯æ´ã£ã¦ä½•ï¼Ÿ
                    </h3>
                    <p style="text-align: center; margin-bottom: 1rem; color: var(--text-light); font-size: 0.9rem;">
                        Amazonãƒ—ãƒ©ã‚¤ãƒ ä¼šå“¡ãªã‚‰è¿½åŠ æ–™é‡‘ãªã—ã§ãƒ’ãƒ­ã‚’å¿œæ´ã§ãã¾ã™ï¼<br>
                        è©³ã—ãã¯ä»¥ä¸‹ã®æ¼«ç”»ã¨å‹•ç”»ã‚’ã”è¦§ãã ã•ã„ ğŸ‘‡
                    </p>

                    <!-- æ¼«ç”»ã§è§£èª¬ -->
                    <div style="margin-bottom: 1.5rem;">
                        <img src="images/twitch-subscrube-manga.jpg" alt="ã‚µãƒ–ã‚¹ã‚¯æ”¯æ´ã®è§£èª¬æ¼«ç”»"
                            style="width: 100%; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
                    </div>

                    <!-- å‹•ç”»ã§è©³ã—ãè§£èª¬ -->
                    <div
                        style="background: #f0f9ff; border: 2px solid #3b82f6; border-radius: 12px; padding: 1rem; text-align: center;">
                        <p style="margin-bottom: 0.75rem; font-weight: 600; color: #1e40af;">
                            ğŸ“º å‹•ç”»ã§ã‚‚ã£ã¨è©³ã—ãè§£èª¬ã•ã‚Œã¦ã„ã¾ã™
                        </p>
                        <a href="https://www.youtube.com/watch?v=tVwWNYnaynY" target="_blank"
                            style="display: inline-flex; align-items: center; gap: 0.5rem; background: #ef4444; color: white; padding: 0.75rem 1.5rem; border-radius: 30px; text-decoration: none; font-weight: 600; transition: all 0.2s;">
                            â–¶ï¸ YouTubeã§è¦‹ã‚‹
                        </a>
                        <p style="margin-top: 0.5rem; font-size: 0.8rem; color: var(--text-light);">
                            â€»å¤–éƒ¨ã‚µã‚¤ãƒˆï¼ˆYouTubeï¼‰ãŒé–‹ãã¾ã™
                        </p>
                    </div>
                </div>

                <!-- ãƒã‚¤ã‚¯ãƒ­ã‚³ãƒ”ãƒ¼ -->
                <p
                    style="text-align: center; margin-top: 2rem; padding: 1rem; background: var(--bg-light); border-radius: 8px; font-size: 0.9rem; color: var(--text-light);">
                    ã„ãŸã ã„ãŸã”æ”¯æ´ã¯ã€ã‚µã‚¤ãƒˆé‹å–¶è²»ãŠã‚ˆã³å­ä¾›ãŸã¡ã®æœªæ¥ã‚’å®ˆã‚‹æ´»å‹•ã«å¤§åˆ‡ã«ä½¿ã‚ã›ã¦ã„ãŸã ãã¾ã™ã€‚
                </p>
            </section>
        </div>
    </main>

    <!-- Amazoné¸æŠãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div id="amazonModal" class="support-modal" style="display: none;">
        <div class="support-modal-overlay" onclick="closeAmazonModal()"></div>
        <div class="support-modal-content">
            <button class="support-modal-close" onclick="closeAmazonModal()">Ã—</button>
            <h3 style="text-align: center; margin-bottom: 1.5rem; color: var(--primary-dark);">
                ğŸ›’ Amazonã§æ”¯æ´ã™ã‚‹æ–¹æ³•ã‚’é¸ã¶
            </h3>
            <div class="support-modal-buttons">
                <a href="https://www.amazon.co.jp/?tag=meiyaku-22" target="_blank" class="support-modal-btn"
                    style="background: linear-gradient(135deg, #ff9900, #ffb84d);">
                    <span class="support-modal-btn-icon">ğŸ›’</span>
                    <span class="support-modal-btn-text">ã„ã¤ã‚‚ã®ãŠè²·ã„ç‰©ã§æ”¯æ´<br><small>ï¼ˆAmazonãƒˆãƒƒãƒ—ã¸ï¼‰</small></span>
                </a>
                <a href="https://www.amazon.jp/hz/wishlist/ls/2HSAZLNOVN09G?ref_=wl_share" target="_blank"
                    class="support-modal-btn" style="background: linear-gradient(135deg, #e91e63, #f48fb1);">
                    <span class="support-modal-btn-icon">ğŸ</span>
                    <span class="support-modal-btn-text">ã»ã—ã„ç‰©ãƒªã‚¹ãƒˆã‹ã‚‰å·®ã—å…¥ã‚Œã™ã‚‹</span>
                </a>
            </div>
        </div>
    </div>

    <!-- é…ä¿¡æŠ•ã’éŠ­ãƒ¢ãƒ¼ãƒ€ãƒ« -->
    <div id="donateModal" class="support-modal" style="display: none;">
        <div class="support-modal-overlay" onclick="closeDonateModal()"></div>
        <div class="support-modal-content">
            <button class="support-modal-close" onclick="closeDonateModal()">Ã—</button>
            <h3 style="text-align: center; margin-bottom: 1.5rem; color: var(--primary-dark);">
                ğŸ å„é…ä¿¡ã‚µã‚¤ãƒˆã§å¿œæ´ã™ã‚‹
            </h3>
            <div class="support-modal-buttons donate-grid">
                <a href="https://www.tiktok.com/@meiyaku_knight" target="_blank" class="donate-card">
                    <img src="images/donate-tiktok.jpg" alt="TikTok">
                </a>
                <a href="https://twitcasting.tv/tabekirimaru" target="_blank" class="donate-card">
                    <img src="images/donate-twitcasting.jpg" alt="ãƒ„ã‚¤ã‚­ãƒ£ã‚¹">
                </a>
                <a href="https://www.twitch.tv/meiyakuknights" target="_blank" class="donate-card">
                    <img src="images/donate-twitch.jpg" alt="Twitch">
                </a>
                <a href="https://www.youtube.com/@meiyaku_knights" target="_blank" class="donate-card">
                    <img src="images/donate-youtube.jpg" alt="YouTube">
                </a>
            </div>
        </div>
    </div>

    <script>
        // ===== Supabaseè¨­å®š =====
        const SUPABASE_URL = 'https://neyhxbdgcqtnyxpuuiqx.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5leWh4YmRnY3F0bnl4cHV1aXF4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjUzMzE1NDcsImV4cCI6MjA4MDkwNzU0N30.5hfxRgrPI4QKZtC2UWMYOSniiaWaLMuXOFxQfN8_H7E';

        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        // ===== ãƒ–ãƒ©ã‚¦ã‚¶ãƒ•ã‚£ãƒ³ã‚¬ãƒ¼ãƒ—ãƒªãƒ³ãƒˆç”Ÿæˆï¼ˆç°¡æ˜“ç‰ˆï¼‰ =====
        function generateFingerprint() {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            ctx.textBaseline = 'alphabetic';
            ctx.font = '14px Arial';
            ctx.fillText('fingerprint', 2, 15);
            const canvasData = canvas.toDataURL();

            const fingerprint = [
                navigator.userAgent,
                navigator.language,
                screen.width + 'x' + screen.height,
                new Date().getTimezoneOffset(),
                canvasData.slice(-50)
            ].join('|');

            // ç°¡æ˜“ãƒãƒƒã‚·ãƒ¥
            let hash = 0;
            for (let i = 0; i < fingerprint.length; i++) {
                const char = fingerprint.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash = hash & hash;
            }
            return 'fp_' + Math.abs(hash).toString(16);
        }

        const userFingerprint = generateFingerprint();
        console.log('User Fingerprint:', userFingerprint);

        // ===== ãƒ­ã‚°ã‚¤ãƒ³å‡¦ç† =====
        let isLoggedIn = false;
        let currentUser = null;

        async function checkLoginStatus() {
            // â˜… Supabase Auth ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒã‚§ãƒƒã‚¯ï¼ˆGoogle OAuth ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†ï¼‰â˜…
            try {
                const { data: { session } } = await supabase.auth.getSession();
                if (session && session.user) {
                    const user = session.user;
                    const email = user.email;
                    const displayName = user.user_metadata?.full_name || user.user_metadata?.name || email.split('@')[0];

                    console.log('Supabase Auth ã‚»ãƒƒã‚·ãƒ§ãƒ³æ¤œå‡º:', email);

                    // ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã§ã®ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒƒã‚¯
                    try {
                        const { data: blockedByEmail } = await supabase
                            .from('blocked_users')
                            .select('blocked_email')
                            .eq('blocked_email', email)
                            .single();

                        if (blockedByEmail) {
                            // ãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ã‚‹å ´åˆã¯ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã—ã¦è­¦å‘Š
                            await supabase.auth.signOut();
                            showBlockedScreen(email);
                            return;
                        }
                    } catch (e) {
                        // ãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ãªã„å ´åˆã¯ç¶šè¡Œ
                    }

                    // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜ã—ã¦ãƒ­ã‚°ã‚¤ãƒ³
                    localStorage.setItem('community_login', JSON.stringify({
                        name: displayName,
                        email: email,
                        provider: 'google',
                        timestamp: Date.now()
                    }));

                    loginSuccess(displayName);
                    return;
                }
            } catch (e) {
                console.log('Supabase Auth ã‚»ãƒƒã‚·ãƒ§ãƒ³ãªã—');
            }

            // ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒƒã‚¯ï¼ˆæœ€å„ªå…ˆï¼‰- fingerprint
            try {
                const { data: blockedByFp } = await supabase
                    .from('blocked_users')
                    .select('fingerprint')
                    .eq('fingerprint', userFingerprint)
                    .single();

                if (blockedByFp) {
                    showBlockedScreen();
                    return;
                }
            } catch (e) {
                // ãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ãªã„å ´åˆã¯ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã®ã§ç„¡è¦–
            }

            // é€šå¸¸ã®ãƒ­ã‚°ã‚¤ãƒ³ãƒã‚§ãƒƒã‚¯
            const savedLogin = localStorage.getItem('community_login');
            if (savedLogin) {
                const loginData = JSON.parse(savedLogin);
                if (Date.now() - loginData.timestamp < 24 * 60 * 60 * 1000) { // 24æ™‚é–“æœ‰åŠ¹

                    // ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã§ã®ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒƒã‚¯ï¼ˆé‡è¦ï¼ï¼‰
                    if (loginData.email) {
                        try {
                            const { data: blockedByEmail } = await supabase
                                .from('blocked_users')
                                .select('blocked_email')
                                .eq('blocked_email', loginData.email)
                                .single();

                            if (blockedByEmail) {
                                // ãƒ–ãƒ­ãƒƒã‚¯ã•ã‚ŒãŸãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã®å ´åˆã€ãƒ­ã‚°ã‚¤ãƒ³æƒ…å ±ã‚’å‰Šé™¤ã—ã¦è­¦å‘Šè¡¨ç¤º
                                localStorage.removeItem('community_login');
                                showBlockedScreen(loginData.email);
                                return;
                            }
                        } catch (e) {
                            // ãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ãªã„å ´åˆã¯ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã®ã§ç„¡è¦–
                        }
                    }

                    loginSuccess(loginData.name);
                    return;
                }
            }
            document.getElementById('loginGate').classList.remove('hidden');
        }

        // ãƒ–ãƒ­ãƒƒã‚¯è­¦å‘Šç”»é¢
        function showBlockedScreen(blockedEmail = null) {
            document.body.innerHTML = `
                <div style="
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f0f23 100%);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    z-index: 99999;
                ">
                    <div style="
                        max-width: 600px;
                        padding: 3rem;
                        text-align: center;
                        color: white;
                    ">
                        <div style="
                            font-size: 6rem;
                            margin-bottom: 1rem;
                            animation: pulse 2s infinite;
                        ">ğŸš¨</div>
                        
                        <h1 style="
                            color: #ef4444;
                            font-size: 2rem;
                            margin-bottom: 1.5rem;
                            text-shadow: 0 0 20px rgba(239, 68, 68, 0.5);
                        ">âš ï¸ ã‚¢ã‚¯ã‚»ã‚¹ãŒãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ã¾ã™ âš ï¸</h1>
                        
                        <div style="
                            background: rgba(255, 255, 255, 0.1);
                            border: 2px solid #ef4444;
                            border-radius: 12px;
                            padding: 1.5rem;
                            margin-bottom: 1.5rem;
                            "><p style="font-size: 1rem; color: #fca5a5; margin-bottom: 1rem;">
                                ãƒ–ãƒ­ãƒƒã‚¯å¯¾è±¡æƒ…å ±:
                            </p>
                            <p style="
                                font-family: monospace;
                                font-size: 1rem;
                                color: #f87171;
                                background: rgba(0,0,0,0.3);
                                padding: 0.75rem;
                                border-radius: 8px;
                                word-break: break-all;
                            ">${blockedEmail ? 'ğŸ“§ ' + blockedEmail : 'ğŸ”’ ç«¯æœ«ID: ' + userFingerprint}</p>
                        </div>
                        
                        <p style="
                            font-size: 1.1rem;
                            color: #fecaca;
                            margin-bottom: 1.5rem;
                            line-height: 1.8;
                        ">
                            ã“ã®ã‚µã‚¤ãƒˆã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ãŒåˆ¶é™ã•ã‚Œã¦ã„ã¾ã™ã€‚<br>
                            ä¸æ­£è¡Œç‚ºãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸã€‚
                        </p>
                        
                        <div style="
                            background: rgba(220, 38, 38, 0.2);
                            border-left: 4px solid #dc2626;
                            padding: 1rem;
                            text-align: left;
                            margin-bottom: 1.5rem;
                            border-radius: 4px;
                        ">
                            <p style="color: #fca5a5; font-size: 0.95rem; margin-bottom: 0.5rem;">
                                âš–ï¸ <strong>æ³•çš„è­¦å‘Š</strong>
                            </p>
                            <p style="color: #fed7aa; font-size: 0.9rem; line-height: 1.6;">
                                ã“ã®ã‚µã‚¤ãƒˆã‚’è’ã‚‰ã™è¡Œç‚ºã¯ã€å¨åŠ›æ¥­å‹™å¦¨å®³ç½ªç­‰ã®é•æ³•è¡Œç‚ºã«è©²å½“ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
                                æ‚ªè³ªãªå ´åˆã¯ã€<strong>ç™ºä¿¡è€…æƒ…å ±é–‹ç¤ºè«‹æ±‚</strong>ãŠã‚ˆã³<strong>æ³•çš„æªç½®</strong>ã‚’æ¤œè¨ã„ãŸã—ã¾ã™ã€‚
                            </p>
                        </div>
                        
                        <p style="color: #94a3b8; font-size: 0.85rem;">
                            é–“é•ã£ã¦ãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ã‚‹ã¨æ€ã‚ã‚Œã‚‹å ´åˆã¯ã€<br>
                            ä»¥ä¸‹ã®é€£çµ¡å…ˆã«ã”é€£çµ¡ãã ã•ã„ã€‚<br><br>
                            <a href="https://x.com/meiyaku_knights" target="_blank" 
                               style="color: #60a5fa; text-decoration: none; display: inline-flex; align-items: center; gap: 0.5rem;">
                                ğŸ“± Xï¼ˆTwitterï¼‰: @meiyaku_knights
                            </a>
                        </p>
                    </div>
                </div>
                <style>
                    @keyframes pulse {
                        0%, 100% { transform: scale(1); }
                        50% { transform: scale(1.1); }
                    }
                </style>
            `;
        }

        function loginSuccess(name) {
            isLoggedIn = true;
            currentUser = name;
            document.getElementById('loginGate').classList.add('hidden');
            document.getElementById('userInfo').style.display = 'flex';
            document.getElementById('userName').textContent = name;
        }

        // åˆæœŸãƒã‚§ãƒƒã‚¯
        checkLoginStatus();

        // ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¹ã‚³ãƒ¼ãƒ—ã«é–¢æ•°ã‚’å…¬é–‹ï¼ˆonclickå±æ€§ã‹ã‚‰å‘¼ã³å‡ºã™ãŸã‚ï¼‰
        window.loginWithGoogle = function () {
            // TODO: Firebase Googleèªè¨¼
            // firebase.auth().signInWithPopup(provider)
            alert('Googleèªè¨¼ã¯æº–å‚™ä¸­ã§ã™ã€‚ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰ã‚’ãŠä½¿ã„ãã ã•ã„ã€‚');
        };

        window.loginDemo = function () {
            let name = prompt('ãƒãƒ³ãƒ‰ãƒ«ãƒãƒ¼ãƒ ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:', 'ã‚²ã‚¹ãƒˆ');
            // nullï¼ˆã‚­ãƒ£ãƒ³ã‚»ãƒ«ï¼‰ã¾ãŸã¯ç©ºã®å ´åˆã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆåã‚’ä½¿ç”¨
            if (name === null) {
                name = 'ã‚²ã‚¹ãƒˆ';
            }
            if (name.trim() === '') {
                name = 'ã‚²ã‚¹ãƒˆ';
            }
            console.log('ãƒ­ã‚°ã‚¤ãƒ³å‡¦ç†é–‹å§‹:', name);
            localStorage.setItem('community_login', JSON.stringify({
                name: name,
                timestamp: Date.now()
            }));
            loginSuccess(name);
        };

        window.logout = async function () {
            // Supabase Auth ã‹ã‚‰ã‚‚ã‚µã‚¤ãƒ³ã‚¢ã‚¦ãƒˆ
            try {
                await supabase.auth.signOut();
            } catch (e) {
                console.log('Supabase signOut error:', e);
            }
            localStorage.removeItem('community_login');
            location.reload();
        };

        // ===== ãƒ­ã‚°ã‚¤ãƒ³ãƒœã‚¿ãƒ³ ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ =====
        console.log('ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼è¨­å®šé–‹å§‹');
        const btnGoogle = document.getElementById('btnLoginGoogle');
        const btnDemo = document.getElementById('btnLoginDemo');
        console.log('btnGoogle:', btnGoogle);
        console.log('btnDemo:', btnDemo);

        if (btnGoogle) {
            btnGoogle.addEventListener('click', async function () {
                console.log('Googleãƒ­ã‚°ã‚¤ãƒ³ãƒœã‚¿ãƒ³ãŒã‚¯ãƒªãƒƒã‚¯ã•ã‚Œã¾ã—ãŸ');

                try {
                    // Supabase Auth Google OAuth
                    const { data, error } = await supabase.auth.signInWithOAuth({
                        provider: 'google',
                        options: {
                            redirectTo: window.location.origin + '/community.html'
                        }
                    });

                    if (error) {
                        console.error('Googleèªè¨¼ã‚¨ãƒ©ãƒ¼:', error);
                        alert('Googleèªè¨¼ã«å¤±æ•—ã—ã¾ã—ãŸ: ' + error.message);
                    }
                } catch (e) {
                    console.error('Googleèªè¨¼ä¾‹å¤–:', e);
                    alert('Googleèªè¨¼ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ã—ã°ã‚‰ãå¾…ã£ã¦ã‹ã‚‰å†åº¦ãŠè©¦ã—ãã ã•ã„ã€‚');
                }
            });
        }

        if (btnDemo) {
            btnDemo.addEventListener('click', function () {
                console.log('ãƒ‡ãƒ¢ãƒ­ã‚°ã‚¤ãƒ³ãƒœã‚¿ãƒ³ãŒã‚¯ãƒªãƒƒã‚¯ã•ã‚Œã¾ã—ãŸ');
                const name = prompt('ãƒãƒ³ãƒ‰ãƒ«ãƒãƒ¼ãƒ ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:', 'ã‚²ã‚¹ãƒˆ');
                console.log('å…¥åŠ›ã•ã‚ŒãŸåå‰:', name);
                if (name) {
                    localStorage.setItem('community_login', JSON.stringify({
                        name: name,
                        timestamp: Date.now()
                    }));
                    loginSuccess(name);
                }
            });
        }

        // ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ãƒ­ã‚°ã‚¤ãƒ³ãƒœã‚¿ãƒ³
        const btnEmail = document.getElementById('btnLoginEmail');
        if (btnEmail) {
            btnEmail.addEventListener('click', async function () {
                const email = document.getElementById('loginEmail').value.trim();

                if (!email) {
                    alert('ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                    return;
                }

                // ç°¡æ˜“ãƒ¡ãƒ¼ãƒ«å½¢å¼ãƒã‚§ãƒƒã‚¯
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailRegex.test(email)) {
                    alert('æœ‰åŠ¹ãªãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                    return;
                }

                console.log('ãƒ¡ãƒ¼ãƒ«ãƒ­ã‚°ã‚¤ãƒ³:', email);

                // â˜… ãƒ­ã‚°ã‚¤ãƒ³å‰ã«ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒƒã‚¯ â˜…
                try {
                    const { data: blockedByEmail } = await supabase
                        .from('blocked_users')
                        .select('blocked_email')
                        .eq('blocked_email', email)
                        .single();

                    if (blockedByEmail) {
                        showBlockedScreen(email);
                        return;
                    }
                } catch (e) {
                    // ãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ãªã„å ´åˆã¯ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã®ã§ç¶šè¡Œ
                }

                // ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’åå‰ã¨ã—ã¦ä¿å­˜ï¼ˆãƒ‰ãƒ¡ã‚¤ãƒ³éƒ¨åˆ†ã‚’é™¤å»ï¼‰
                const displayName = email.split('@')[0];

                localStorage.setItem('community_login', JSON.stringify({
                    name: displayName,
                    email: email,
                    timestamp: Date.now()
                }));

                loginSuccess(displayName);
            });
        }

        // ===== ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ =====
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', () => {
                document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                item.classList.add('active');

                const section = item.dataset.section;
                document.querySelectorAll('.page-section').forEach(s => s.classList.remove('active'));
                document.getElementById(`section-${section}`).classList.add('active');
            });
        });

        // ===== éƒ½é“åºœçœŒã‚«ãƒ¼ãƒ‰ =====
        document.querySelectorAll('.prefecture-card').forEach(card => {
            card.addEventListener('click', () => {
                document.querySelectorAll('.prefecture-card').forEach(c => c.classList.remove('active'));
                card.classList.add('active');
                currentFilters.prefecture = card.dataset.pref;
                applyFilters();
            });
        });

        // ===== ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆã‚µã‚¤ãƒ‰ãƒãƒ¼ï¼‰ =====

        // ã‚µã‚¤ãƒ‰ãƒãƒ¼æ¤œç´¢ãƒœãƒƒã‚¯ã‚¹
        document.getElementById('sidebarSearch').addEventListener('input', (e) => {
            currentFilters.search = e.target.value.trim().toLowerCase();
            applyFilters();
        });

        // ã‚¿ã‚°ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹å‹•çš„ç”Ÿæˆ
        function updateTagCheckboxes() {
            const tagCounts = {};
            allExperiences.forEach(exp => {
                exp.tags.forEach(tag => {
                    tagCounts[tag] = (tagCounts[tag] || 0) + 1;
                });
            });

            const container = document.getElementById('tagCheckboxes');
            container.innerHTML = '';

            // ã‚¿ã‚°ã‚’åå‰é †ã«ã‚½ãƒ¼ãƒˆï¼ˆã¾ãŸã¯ä»¶æ•°é †ï¼‰
            const sortedTags = Object.keys(tagCounts).sort();

            sortedTags.forEach(tag => {
                const count = tagCounts[tag];
                const label = document.createElement('label');
                label.className = 'checkbox-item';
                label.innerHTML = `
            < input type = "checkbox" name = "tag-filter" value = "${tag}" >
            ${tag} < span style = "color: #9ca3af; font-size: 0.8rem;" > (${count})</span >
            `;

                // ãƒã‚§ãƒ³ã‚¸ã‚¤ãƒ™ãƒ³ãƒˆ
                label.querySelector('input').addEventListener('change', () => {
                    applyFilters();
                });

                container.appendChild(label);
            });
        }

        // ===== ã‚¿ã‚°ãƒãƒƒãƒ—ï¼ˆæŠ•ç¨¿ãƒ•ã‚©ãƒ¼ãƒ ç”¨ï¼‰ =====
        document.querySelectorAll('.tag-chip').forEach(chip => {
            chip.addEventListener('click', () => {
                chip.classList.toggle('selected');
            });
        });

        // ===== ä½“é¨“è«‡ãƒ‡ãƒ¼ã‚¿ç®¡ç† =====
        let allExperiences = [];
        let currentFilters = {
            prefecture: 'å…¨å›½',
            search: ''
        };

        // ã‚¢ã‚¤ã‚³ãƒ³é¸æŠï¼ˆãƒ•ã‚§ãƒ¼ã‚ºã«å¿œã˜ã¦ï¼‰
        function getPhaseIcon(phase) {
            const icons = {
                'æº–å‚™ä¸­': 'ğŸ“‹',
                'èª¿åœä¸­': 'âš–ï¸',
                'è¨´è¨Ÿä¸­': 'ğŸ›ï¸',
                'è§£æ±ºæ¸ˆã¿': 'âœ…'
            };
            return icons[phase] || 'ğŸ“';
        }

        // ä½“é¨“è«‡ã‚’è¡¨ç¤º
        function renderExperiences(experiences) {
            const container = document.getElementById('experienceList');
            const countEl = document.getElementById('experienceCount');

            if (experiences.length === 0) {
                container.innerHTML = `
            < div style = "text-align: center; padding: 2rem; color: var(--text-light);" >
            è©²å½“ã™ã‚‹ä½“é¨“è«‡ãŒã‚ã‚Šã¾ã›ã‚“
                    </div >
                `;
                countEl.textContent = '(0ä»¶)';
                return;
            }

            countEl.textContent = `(${experiences.length}ä»¶)`;

            container.innerHTML = experiences.map(exp => `
                < div class= "experience-item" data - id="${exp.id}" >
                    <div class="experience-icon">${getPhaseIcon(exp.phase)}</div>
                    <div class="experience-content">
                        <div class="experience-header">
                            <span class="experience-name">${exp.author}</span>
                            <span class="experience-meta">${exp.prefecture} / ${exp.phase}</span>
                        </div>
                        <h4 class="experience-title">${exp.title}</h4>
                        <p class="experience-summary">${exp.excerpt}</p>
                        <div class="experience-tags">
                            ${exp.tags.map(tag => `<span class="tag-mini">${tag}</span>`).join('')}
                        </div>
                        <div class="experience-footer">
                            <button class="action-btn" onclick="toggleComment('${exp.id}')">
                                ğŸ’¬ <span id="comment-count-${exp.id}">${exp.comments}</span>ã‚³ãƒ¡ãƒ³ãƒˆ
                            </button>
                            <button class="action-btn" onclick="toggleLike('${exp.id}')">
                                ğŸ‘ <span id="like-count-${exp.id}">${exp.likes}</span> å‚è€ƒã«ãªã£ãŸ
                            </button>
                            <span style="margin-left: auto;">ğŸ“… ${exp.date}</span>
                        </div>
                        <!-- ã‚³ãƒ¡ãƒ³ãƒˆå…¥åŠ›ã‚¨ãƒªã‚¢ï¼ˆåˆæœŸã¯éè¡¨ç¤ºï¼‰ -->
                        <div id="comment-area-${exp.id}" class="comment-area" style="display: none; margin-top: 1rem; padding-top: 1rem; border-top: 1px solid #eee;">
                             <div class="comment-list" id="comment-list-${exp.id}" style="margin-bottom: 0.5rem; background: #f9fafb; padding: 0.5rem; border-radius: 8px;">
                                <p style="font-size: 0.85rem; color: #666;">ï¼ˆã¾ã ã‚³ãƒ¡ãƒ³ãƒˆã¯ã‚ã‚Šã¾ã›ã‚“ï¼‰</p>
                             </div>
                             <div style="display: flex; gap: 0.5rem;">
                                 <input type="text" class="form-input" id="comment-input-${exp.id}" placeholder="ã‚³ãƒ¡ãƒ³ãƒˆã‚’å…¥åŠ›..." style="padding: 0.5rem; font-size: 0.9rem;">
                                 <button class="btn btn-primary" onclick="submitComment('${exp.id}')" style="min-height: auto; padding: 0.5rem 1rem; font-size: 0.9rem;">é€ä¿¡</button>
                             </div>
                        </div>
                    </div>
                </div >
                `).join('');
        }

        // ===== ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³æ©Ÿèƒ½ï¼ˆãƒ¢ãƒƒã‚¯ï¼‰ =====
        function toggleLike(id) {
            if (!isLoggedIn) {
                alert('ã€Œå‚è€ƒã«ãªã£ãŸã€ã‚’æŠ¼ã™ã«ã¯ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ã§ã™');
                return;
            }
            const countEl = document.getElementById(`like - count - ${id}`);
            let count = parseInt(countEl.textContent);
            count++;
            countEl.textContent = count;
            // è¦–è¦šçš„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ï¼ˆç°¡å˜ãªã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ä»£ã‚ã‚Šï¼‰
            countEl.parentElement.style.color = 'var(--primary-color)';
            countEl.parentElement.innerHTML = `ğŸ‘ <strong>${count}</strong> å‚è€ƒã«ãªã£ãŸï¼ˆé€ä¿¡æ¸ˆï¼‰`;
        }

        function toggleComment(id) {
            const area = document.getElementById(`comment - area - ${id}`);
            if (area.style.display === 'none') {
                area.style.display = 'block';
            } else {
                area.style.display = 'none';
            }
        }

        function submitComment(id) {
            if (!isLoggedIn) {
                alert('ã‚³ãƒ¡ãƒ³ãƒˆã™ã‚‹ã«ã¯ãƒ­ã‚°ã‚¤ãƒ³ãŒå¿…è¦ã§ã™');
                return;
            }
            const input = document.getElementById(`comment - input - ${id}`);
            const text = input.value.trim();
            if (!text) return;

            // ã‚³ãƒ¡ãƒ³ãƒˆãƒªã‚¹ãƒˆã«è¿½åŠ ï¼ˆãƒ¢ãƒƒã‚¯ï¼‰
            const list = document.getElementById(`comment - list - ${id}`);
            // "ã¾ã ã‚³ãƒ¡ãƒ³ãƒˆã¯ã‚ã‚Šã¾ã›ã‚“" ã‚’ã‚¯ãƒªã‚¢ï¼ˆåˆå›ã®ã¿ï¼‰
            if (list.querySelector('p')?.textContent.includes('ã¾ã ã‚³ãƒ¡ãƒ³ãƒˆ')) {
                list.innerHTML = '';
            }

            const newComment = document.createElement('div');
            newComment.style.padding = '0.5rem 0';
            newComment.style.borderBottom = '1px solid #eee';
            newComment.innerHTML = `
            < span style = "font-weight: bold; font-size: 0.85rem;" > ${currentUser || 'ã‚²ã‚¹ãƒˆ'}</span >:
        <span style="font-size: 0.9rem;">${text}</span>
        `;
            list.appendChild(newComment);

            // ã‚«ã‚¦ãƒ³ãƒˆæ›´æ–°
            const countEl = document.getElementById(`comment - count - ${id} `);
            countEl.textContent = parseInt(countEl.textContent) + 1;

            input.value = '';
        }

        // ãƒ•ã‚£ãƒ«ã‚¿é©ç”¨
        function applyFilters() {
            let filtered = [...allExperiences];

            // éƒ½é“åºœçœŒãƒ•ã‚£ãƒ«ã‚¿
            if (currentFilters.prefecture && currentFilters.prefecture !== 'å…¨å›½') {
                filtered = filtered.filter(exp => exp.prefecture === currentFilters.prefecture);
            }

            // ã‚¿ã‚°ãƒ•ã‚£ãƒ«ã‚¿ï¼ˆãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ï¼šä¸€ã¤ã§ã‚‚ãƒãƒƒãƒã™ã‚Œã°è¡¨ç¤º ORæ¡ä»¶ï¼‰
            const checkedTags = Array.from(document.querySelectorAll('input[name="tag-filter"]:checked'))
                .map(input => input.value);

            if (checkedTags.length > 0) {
                filtered = filtered.filter(exp =>
                    // checkedTagsã®ã„ãšã‚Œã‹ãŒexp.tagsã«å«ã¾ã‚Œã¦ã„ã‚‹ã‹
                    checkedTags.some(checkedTag => exp.tags.includes(checkedTag))
                );
            }

            // ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œç´¢
            if (currentFilters.search) {
                const searchTerm = currentFilters.search;
                filtered = filtered.filter(exp =>
                    exp.title.toLowerCase().includes(searchTerm) ||
                    exp.excerpt.toLowerCase().includes(searchTerm) ||
                    exp.author.toLowerCase().includes(searchTerm) ||
                    exp.tags.some(tag => tag.toLowerCase().includes(searchTerm))
                );
            }

            renderExperiences(filtered);
            updatePrefectureCounts();
        }

        // éƒ½é“åºœçœŒã‚«ãƒ¼ãƒ‰ã®ä»¶æ•°ã‚’æ›´æ–°
        function updatePrefectureCounts() {
            document.querySelectorAll('.prefecture-card').forEach(card => {
                const pref = card.dataset.pref;
                let count;
                if (pref === 'å…¨å›½') {
                    count = allExperiences.length;
                } else {
                    count = allExperiences.filter(exp => exp.prefecture === pref).length;
                }
                card.querySelector('.prefecture-count').textContent = `${count} ä»¶`;
            });
        }

        // ã‚¿ã‚°ã‚ªãƒ—ã‚·ãƒ§ãƒ³å‹•çš„ç”Ÿæˆ
        function updateTagOptions() {
            const tagSet = new Set();
            allExperiences.forEach(exp => {
                exp.tags.forEach(tag => tagSet.add(tag));
            });

            const select = document.getElementById('tagFilter');
            select.innerHTML = '<option value="">å…¨ã‚¿ã‚°</option>';
            [...tagSet].sort().forEach(tag => {
                select.innerHTML += `< option value = "${tag}" > ${tag}</option > `;
            });
        }

        // ä½“é¨“è«‡èª­ã¿è¾¼ã¿ï¼ˆSupabaseã‹ã‚‰æ‰¿èªæ¸ˆã¿æŠ•ç¨¿ã‚’å–å¾—ã€ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã§ãƒ­ãƒ¼ã‚«ãƒ«JSONï¼‰
        async function loadExperiences() {
            const container = document.getElementById('experienceList');
            try {
                // ã¾ãšSupabaseã‹ã‚‰æ‰¿èªæ¸ˆã¿æŠ•ç¨¿ã‚’å–å¾—
                const { data: supabasePosts, error } = await supabase
                    .from('posts')
                    .select('*')
                    .eq('status', 'approved')
                    .order('created_at', { ascending: false });

                if (!error && supabasePosts && supabasePosts.length > 0) {
                    // Supabaseãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºç”¨ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã«å¤‰æ›
                    allExperiences = supabasePosts.map(post => ({
                        id: post.id,
                        title: post.title,
                        author: post.author_name,
                        prefecture: post.prefecture || 'æœªè¨­å®š',
                        phase: post.phase || 'é€²è¡Œä¸­',
                        excerpt: post.content.substring(0, 150) + (post.content.length > 150 ? '...' : ''),
                        tags: post.tags || [],
                        comments: 0,
                        likes: 0,
                        date: new Date(post.created_at).toLocaleDateString('ja-JP')
                    }));
                    console.log(`Supabaseã‹ã‚‰${allExperiences.length} ä»¶ã®æ‰¿èªæ¸ˆã¿æŠ•ç¨¿ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ`);
                } else {
                    // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: ãƒ­ãƒ¼ã‚«ãƒ«JSONã‹ã‚‰èª­ã¿è¾¼ã¿
                    console.log('Supabaseã‹ã‚‰å–å¾—ã§ããªã„ãŸã‚ã€ãƒ­ãƒ¼ã‚«ãƒ«JSONã‚’ä½¿ç”¨ã—ã¾ã™');
                    const response = await fetch('data/experiences.json');
                    allExperiences = await response.json();
                    allExperiences.sort((a, b) => new Date(b.date) - new Date(a.date));
                }

                updateTagCheckboxes();
                updatePrefectureCounts();
                renderExperiences(allExperiences);
                console.log(`ä½“é¨“è«‡ã‚’${allExperiences.length} ä»¶èª­ã¿è¾¼ã¿ã¾ã—ãŸ`);
            } catch (error) {
                console.error('ä½“é¨“è«‡èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
                // æœ€çµ‚ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
                try {
                    const response = await fetch('data/experiences.json');
                    allExperiences = await response.json();
                    updateTagCheckboxes();
                    updatePrefectureCounts();
                    renderExperiences(allExperiences);
                } catch (e) {
                    container.innerHTML = `
            < div style = "text-align: center; padding: 2rem; color: #dc2626;" >
                ä½“é¨“è«‡ã‚’èª­ã¿è¾¼ã‚ã¾ã›ã‚“ã§ã—ãŸ
                        </div >
            `;
                }
            }
        }

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚
        loadExperiences();

        // ===== ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ =====
        async function handleFormSubmit(event) {
            event.preventDefault();

            const form = document.getElementById('experience-form');
            const submitBtn = form.querySelector('button[type="submit"]');
            const originalBtnText = submitBtn.textContent;
            submitBtn.textContent = 'é€ä¿¡ä¸­...';
            submitBtn.disabled = true;

            try {
                // reCAPTCHA v3 ãƒˆãƒ¼ã‚¯ãƒ³å–å¾—
                let recaptchaToken = null;
                try {
                    recaptchaToken = await grecaptcha.execute('6Lc8JSosAAAAANfpYbwb4-X11lIZnMoEY46kkLh1', { action: 'submit_post' });
                    console.log('reCAPTCHA token obtained');
                } catch (recaptchaError) {
                    console.warn('reCAPTCHA failed, continuing anyway:', recaptchaError);
                }
                // ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒƒã‚¯ï¼ˆfingerprintï¼‰
                const { data: blockedByFp } = await supabase
                    .from('blocked_users')
                    .select('fingerprint')
                    .eq('fingerprint', userFingerprint)
                    .single();

                // ãƒ­ã‚°ã‚¤ãƒ³ä¸­ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å–å¾—
                const savedLogin = localStorage.getItem('community_login');
                const loginData = savedLogin ? JSON.parse(savedLogin) : null;
                const userEmail = loginData?.email || null;

                // ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã§ã®ãƒ–ãƒ­ãƒƒã‚¯ãƒã‚§ãƒƒã‚¯
                let blockedByEmail = null;
                if (userEmail) {
                    const { data } = await supabase
                        .from('blocked_users')
                        .select('blocked_email')
                        .eq('blocked_email', userEmail)
                        .single();
                    blockedByEmail = data;
                }

                if (blockedByFp || blockedByEmail) {
                    // ãƒ–ãƒ­ãƒƒã‚¯ã•ã‚ŒãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ç”¨ã®è­¦å‘Šç”»é¢ï¼ˆå…¨ç”»é¢ï¼‰
                    document.body.innerHTML = `
            < div style = "
        position: fixed;
        top: 0;
        left: 0;
        width: 100 %;
        height: 100 %;
        background: linear - gradient(135deg, #1a1a2e 0 %, #16213e 50 %, #0f0f23 100 %);
        display: flex;
        align - items: center;
        justify - content: center;
        z - index: 99999;
        ">
            < div style = "
        max - width: 600px;
        padding: 3rem;
        text - align: center;
        color: white;
        ">
            < div style = "
        font - size: 6rem;
        margin - bottom: 1rem;
        animation: pulse 2s infinite;
        ">ğŸš¨</div>

            < h1 style = "
        color: #ef4444;
        font - size: 2rem;
        margin - bottom: 1.5rem;
        text - shadow: 0 0 20px rgba(239, 68, 68, 0.5);
        ">âš ï¸ ã‚¢ã‚¯ã‚»ã‚¹ãŒãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ã¾ã™ âš ï¸</h1>

            < div style = "
        background: rgba(255, 255, 255, 0.1);
        border: 2px solid #ef4444;
        border - radius: 12px;
        padding: 1.5rem;
        margin - bottom: 1.5rem;
        ">
            < p style = "font-size: 1rem; color: #fca5a5; margin-bottom: 1rem;" >
                ã‚ãªãŸã®ç«¯æœ«ID:
                                    </p >
            <p style="
                                        font-family: monospace;
                                        font-size: 1.2rem;
                                        color: #f87171;
                                        background: rgba(0,0,0,0.3);
                                        padding: 0.75rem;
                                        border-radius: 8px;
                                        word-break: break-all;
                                    ">${userFingerprint}</p>
                                </div >
                                
                                <p style="
                                    font-size: 1.1rem;
                                    color: #fecaca;
                                    margin-bottom: 1.5rem;
                                    line-height: 1.8;
                                ">
                                    ã“ã®ã‚µã‚¤ãƒˆã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ãŒåˆ¶é™ã•ã‚Œã¦ã„ã¾ã™ã€‚<br>
                                    ä¸æ­£è¡Œç‚ºãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸã€‚
                                </p>
                                
                                <div style="
                                    background: rgba(220, 38, 38, 0.2);
                                    border-left: 4px solid #dc2626;
                                    padding: 1rem;
                                    text-align: left;
                                    margin-bottom: 1.5rem;
                                    border-radius: 4px;
                                ">
                                    <p style="color: #fca5a5; font-size: 0.95rem; margin-bottom: 0.5rem;">
                                        âš–ï¸ <strong>æ³•çš„è­¦å‘Š</strong>
                                    </p>
                                    <p style="color: #fed7aa; font-size: 0.9rem; line-height: 1.6;">
                                        ã“ã®ã‚µã‚¤ãƒˆã‚’è’ã‚‰ã™è¡Œç‚ºã¯ã€å¨åŠ›æ¥­å‹™å¦¨å®³ç½ªç­‰ã®é•æ³•è¡Œç‚ºã«è©²å½“ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
                                        æ‚ªè³ªãªå ´åˆã¯ã€<strong>ç™ºä¿¡è€…æƒ…å ±é–‹ç¤ºè«‹æ±‚</strong>ãŠã‚ˆã³<strong>æ³•çš„æªç½®</strong>ã‚’æ¤œè¨ã„ãŸã—ã¾ã™ã€‚
                                    </p>
                                </div>
                                
                                <p style="color: #94a3b8; font-size: 0.85rem;">
                                    é–“é•ã£ã¦ãƒ–ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ã‚‹ã¨æ€ã‚ã‚Œã‚‹å ´åˆã¯ã€<br>
                                    ä»¥ä¸‹ã®é€£çµ¡å…ˆã«ã”é€£çµ¡ãã ã•ã„ã€‚<br><br>
                                    <a href="https://x.com/meiyaku_knights" target="_blank" 
                                       style="color: #60a5fa; text-decoration: none;">
                                        ğŸ“± Xï¼ˆTwitterï¼‰: @meiyaku_knights
                                    </a>
                                </p>
                            </div>
                        </div>
                        <style>
                            @keyframes pulse {
                                0%, 100% { transform: scale(1); }
                                50% { transform: scale(1.1); }
                            }
                        </style>
                    `;
                    return false;
                }

                const title = document.getElementById('experience-title').value;
                const handleName = document.getElementById('handle-name').value;
                const prefecture = document.getElementById('prefecture').value;
                const phase = document.getElementById('phase')?.value || '';
                const content = document.getElementById('experience-text').value;

                // é¸æŠã•ã‚ŒãŸã‚¿ã‚°ã‚’åé›†
                const selectedTags = [];
                document.querySelectorAll('.tag-chip.selected').forEach(chip => {
                    selectedTags.push(chip.dataset.tag);
                });

                // Supabaseã«ä¿å­˜ï¼ˆãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚‚ä¿å­˜ï¼‰
                const { error } = await supabase
                    .from('posts')
                    .insert({
                        title: title,
                        author_name: handleName,
                        prefecture: prefecture,
                        phase: phase,
                        content: content,
                        tags: selectedTags,
                        status: 'pending',
                        user_fingerprint: userFingerprint,
                        user_email: userEmail,
                        recaptcha_token: recaptchaToken
                    });

                if (error) throw error;

                // æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
                form.innerHTML = `
                    <div style="text-align: center; padding: 2rem; background: #f0fdf4; border-radius: 12px; border: 2px solid #22c55e;">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">âœ…</div>
                        <h3 style="color: #15803d; margin-bottom: 1rem;">æŠ•ç¨¿ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼</h3>
                        <p style="color: #166534; margin-bottom: 1rem;">
                            <strong>${handleName}</strong> æ§˜ã®ä½“é¨“è«‡ã‚’å—ã‘ä»˜ã‘ã¾ã—ãŸã€‚<br>
                            ç®¡ç†è€…ã®ç¢ºèªå¾Œã€ã‚µã‚¤ãƒˆã«æ²è¼‰ã•ã‚Œã¾ã™ã€‚
                        </p>
                        <button class="btn btn-primary" onclick="location.reload()">ç¶šã‘ã¦æŠ•ç¨¿ãƒ»æˆ»ã‚‹</button>
                    </div>
                `;

            } catch (error) {
                console.error('æŠ•ç¨¿ã‚¨ãƒ©ãƒ¼:', error);
                submitBtn.textContent = originalBtnText;
                submitBtn.disabled = false;
                alert('æŠ•ç¨¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚\nã‚¨ãƒ©ãƒ¼: ' + error.message);
            }

            return false;
        }

        // TODO: AIãƒ•ã‚£ãƒ«ã‚¿ãƒ¼å‡¦ç†ï¼ˆå°†æ¥å®Ÿè£…ï¼‰
        // function checkCommentWithAI(comment, userId) {
        //     // AIã§ä¸é©åˆ‡ã‚³ãƒ¡ãƒ³ãƒˆã‚’ãƒã‚§ãƒƒã‚¯
        //     // 3å›æ¤œçŸ¥ã§ãƒ–ãƒ­ãƒƒã‚¯å‡¦ç†
        // }

        // ===== ãŠã™ã™ã‚ã‚³ãƒ³ãƒ†ãƒ³ãƒ„èª­ã¿è¾¼ã¿ï¼ˆSupabaseã‹ã‚‰å–å¾—ï¼‰ =====
        async function loadRecommendations() {
            const grid = document.getElementById('recommendGrid');

            try {
                // Supabaseã‹ã‚‰ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªãŠã™ã™ã‚ã‚’å–å¾—
                const { data, error } = await supabase
                    .from('recommendations')
                    .select('*')
                    .eq('is_active', true)
                    .order('display_order', { ascending: true });

                if (error) throw error;

                if (!data || data.length === 0) {
                    // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: ãƒ­ãƒ¼ã‚«ãƒ«JSONã‚’ä½¿ç”¨
                    console.log('Supabaseã«ãƒ‡ãƒ¼ã‚¿ãŒãªã„ãŸã‚ã€ãƒ­ãƒ¼ã‚«ãƒ«JSONã‚’ä½¿ç”¨');
                    const response = await fetch('data/recommendations.json');
                    const localData = await response.json();
                    renderLocalRecommendations(localData);
                    return;
                }

                // ã‚«ãƒ†ã‚´ãƒªã”ã¨ã«ã‚°ãƒ«ãƒ¼ãƒ—åŒ–
                const grouped = {
                    book: data.filter(d => d.category === 'book'),
                    youtube: data.filter(d => d.category === 'youtube'),
                    music: data.filter(d => d.category === 'music'),
                    quote: data.filter(d => d.category === 'quote')
                };

                const categoryInfo = {
                    book: { icon: 'ğŸ“š', title: 'ãŠã™ã™ã‚æœ¬' },
                    youtube: { icon: 'ğŸ¬', title: 'ãŠã™ã™ã‚YouTube' },
                    music: { icon: 'ğŸµ', title: 'å…ƒæ°—ãŒå‡ºã‚‹éŸ³æ¥½' },
                    quote: { icon: 'ğŸ’¬', title: 'å…ƒæ°—ãŒå‡ºã‚‹è¨€è‘‰' }
                };

                let html = '';

                for (const [category, items] of Object.entries(grouped)) {
                    if (items.length > 0) {
                        const info = categoryInfo[category];
                        html += `
                            <div class="recommend-category">
                                <h4 style="margin-bottom: 1rem; color: var(--primary-dark);">${info.icon} ${info.title}</h4>
                                <div class="recommend-cards">
                                    ${items.map(item => `
                                        <div class="recommend-item-card">
                                            <div class="recommend-item-title">${item.title}</div>
                                            ${item.author ? `<div class="recommend-item-author">${item.author}</div>` : ''}
                                            ${item.description ? `<div class="recommend-item-desc">${item.description}</div>` : ''}
                                            ${item.url ? `<a href="${item.url}" target="_blank" class="recommend-item-link">ğŸ”— è©³ã—ãè¦‹ã‚‹</a>` : ''}
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        `;
                    }
                }

                grid.innerHTML = html || '<div style="color: var(--text-light);">ã¾ã ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒã‚ã‚Šã¾ã›ã‚“</div>';
                console.log('Supabaseã‹ã‚‰ãŠã™ã™ã‚ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ');

            } catch (error) {
                console.error('ãŠã™ã™ã‚èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
                // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
                try {
                    const response = await fetch('data/recommendations.json');
                    const localData = await response.json();
                    renderLocalRecommendations(localData);
                } catch (e) {
                    grid.innerHTML = `
                        <div style="text-align: center; padding: 2rem; color: #dc2626;">
                            ãŠã™ã™ã‚ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’èª­ã¿è¾¼ã‚ã¾ã›ã‚“ã§ã—ãŸ
                        </div>
                    `;
                }
            }
        }

        // ãƒ­ãƒ¼ã‚«ãƒ«JSONç”¨ã®æç”»é–¢æ•°ï¼ˆãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼‰
        function renderLocalRecommendations(data) {
            const grid = document.getElementById('recommendGrid');
            let html = '';

            if (data.books && data.books.length > 0) {
                html += `<div class="recommend-category"><h4>ğŸ“š ãŠã™ã™ã‚æœ¬</h4><div class="recommend-cards">
                    ${data.books.map(b => `<div class="recommend-item-card"><div class="recommend-item-title">${b.title}</div><div class="recommend-item-author">${b.author}</div>${b.url ? `<a href="${b.url}" target="_blank" class="recommend-item-link">ğŸ”—</a>` : ''}</div>`).join('')}
                </div></div>`;
            }
            if (data.youtube && data.youtube.length > 0) {
                html += `<div class="recommend-category"><h4>ğŸ¬ ãŠã™ã™ã‚YouTube</h4><div class="recommend-cards">
                    ${data.youtube.map(y => `<div class="recommend-item-card"><div class="recommend-item-title">${y.title}</div><div class="recommend-item-desc">${y.description}</div>${y.url ? `<a href="${y.url}" target="_blank" class="recommend-item-link">ğŸ”—</a>` : ''}</div>`).join('')}
                </div></div>`;
            }
            if (data.music && data.music.length > 0) {
                html += `<div class="recommend-category"><h4>ğŸµ å…ƒæ°—ãŒå‡ºã‚‹éŸ³æ¥½</h4><div class="recommend-cards">
                    ${data.music.map(m => `<div class="recommend-item-card"><div class="recommend-item-title">${m.title}</div><div class="recommend-item-author">${m.artist}</div><div class="recommend-item-desc">${m.comment}</div></div>`).join('')}
                </div></div>`;
            }
            if (data.quotes && data.quotes.length > 0) {
                html += `<div class="recommend-category"><h4>ğŸ’¬ å…ƒæ°—ãŒå‡ºã‚‹è¨€è‘‰</h4><div class="recommend-cards">
                    ${data.quotes.map(q => `<div class="recommend-item-card"><div class="recommend-item-title">ã€Œ${q.text}ã€</div><div class="recommend-item-author">â€” ${q.author}</div></div>`).join('')}
                </div></div>`;
            }

            grid.innerHTML = html;
        }

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«å®Ÿè¡Œ
        loadRecommendations();

        // ===== æ´»å‹•æ”¯æ´ãƒ¢ãƒ¼ãƒ€ãƒ« =====
        function openAmazonModal() {
            document.getElementById('amazonModal').style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }

        function closeAmazonModal() {
            document.getElementById('amazonModal').style.display = 'none';
            document.body.style.overflow = '';
        }

        function openDonateModal() {
            document.getElementById('donateModal').style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }

        function closeDonateModal() {
            document.getElementById('donateModal').style.display = 'none';
            document.body.style.overflow = '';
        }

        // ESCã‚­ãƒ¼ã§ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹
        document.addEventListener('keydown', function (e) {
            if (e.key === 'Escape') {
                closeAmazonModal();
                closeDonateModal();
            }
        });
    </script>

    <!-- å…è²¬ãƒã‚¤ã‚¯ãƒ­ã‚³ãƒ”ãƒ¼ -->
    <div class="container" style="padding: 2rem 1rem;">
        <div
            style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 8px; padding: 1rem; text-align: center;">
            <p style="font-size: 0.85rem; color: #64748b; margin: 0;">
                â€»æ²è¼‰ã•ã‚Œã¦ã„ã‚‹ä½“é¨“è«‡ã¯å€‹äººã®çµŒé¨“ã«åŸºã¥ãã‚‚ã®ã§ã™ã€‚æ³•çš„ãªåˆ¤æ–­ã«ã¤ã„ã¦ã¯å¿…ãšå¼è­·å£«ç­‰ã®å°‚é–€å®¶ã«ã”ç›¸è«‡ãã ã•ã„ã€‚
                <a href="disclaimer.html" style="color: #3b82f6; text-decoration: underline;">å…è²¬äº‹é …</a>
            </p>
        </div>
    </div>
</body>

</html>